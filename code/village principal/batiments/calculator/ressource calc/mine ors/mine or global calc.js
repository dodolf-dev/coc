import { mine_or1_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";
import { mine_or2_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { mine_or3_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { mine_or4_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { mine_or5_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { mine_or6_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { mine_or7_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { calculerTempsTotalmine_or1 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";
import { calculerTempsTotalmine_or2 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { calculerTempsTotalmine_or3 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { calculerTempsTotalmine_or4 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { calculerTempsTotalmine_or5 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { calculerTempsTotalmine_or6 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { calculerTempsTotalmine_or7 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { calculerTempsRestantmine_or1 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";    
import { calculerTempsRestantmine_or2 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { calculerTempsRestantmine_or3 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { calculerTempsRestantmine_or4 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { calculerTempsRestantmine_or5 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { calculerTempsRestantmine_or6 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { calculerTempsRestantmine_or7 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { calculerTempsdepuisHDVmine_or1 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";
import { calculerTempsdepuisHDVmine_or2 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { calculerTempsdepuisHDVmine_or3 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { calculerTempsdepuisHDVmine_or4 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { calculerTempsdepuisHDVmine_or5 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { calculerTempsdepuisHDVmine_or6 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { calculerTempsdepuisHDVmine_or7 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { calculerTempsConstructionParHDVmine_or1 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";
import { calculerTempsConstructionParHDVmine_or2 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { calculerTempsConstructionParHDVmine_or3 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { calculerTempsConstructionParHDVmine_or4 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { calculerTempsConstructionParHDVmine_or5 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { calculerTempsConstructionParHDVmine_or6 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { calculerTempsConstructionParHDVmine_or7 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { calculerPrixTotalmine_or1 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";
import { calculerPrixTotalmine_or2 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { calculerPrixTotalmine_or3 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { calculerPrixTotalmine_or4 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { calculerPrixTotalmine_or5 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { calculerPrixTotalmine_or6 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { calculerPrixTotalmine_or7 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { calculerPrixRestantmine_or1 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";
import { calculerPrixRestantmine_or2 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { calculerPrixRestantmine_or3 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { calculerPrixRestantmine_or4 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { calculerPrixRestantmine_or5 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { calculerPrixRestantmine_or6 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { calculerPrixRestantmine_or7 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { calculerPrixdepuisHDVmine_or1 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";
import { calculerPrixdepuisHDVmine_or2 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { calculerPrixdepuisHDVmine_or3 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { calculerPrixdepuisHDVmine_or4 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { calculerPrixdepuisHDVmine_or5 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { calculerPrixdepuisHDVmine_or6 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { calculerPrixdepuisHDVmine_or7 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { calculerPrixConstructionParHDVmine_or1 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";
import { calculerPrixConstructionParHDVmine_or2 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { calculerPrixConstructionParHDVmine_or3 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { calculerPrixConstructionParHDVmine_or4 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { calculerPrixConstructionParHDVmine_or5 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { calculerPrixConstructionParHDVmine_or6 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { calculerPrixConstructionParHDVmine_or7 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { calculerExperienceTotalmine_or1 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";
import { calculerExperienceTotalmine_or2 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { calculerExperienceTotalmine_or3 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { calculerExperienceTotalmine_or4 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { calculerExperienceTotalmine_or5 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { calculerExperienceTotalmine_or6 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { calculerExperienceTotalmine_or7 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { calculerExperienceRestantmine_or1 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";
import { calculerExperienceRestantmine_or2 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { calculerExperienceRestantmine_or3 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { calculerExperienceRestantmine_or4 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { calculerExperienceRestantmine_or5 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { calculerExperienceRestantmine_or6 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { calculerExperienceRestantmine_or7 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { calculerExperiencedepuisHDVmine_or1 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";
import { calculerExperiencedepuisHDVmine_or2 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { calculerExperiencedepuisHDVmine_or3 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { calculerExperiencedepuisHDVmine_or4 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { calculerExperiencedepuisHDVmine_or5 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { calculerExperiencedepuisHDVmine_or6 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { calculerExperiencedepuisHDVmine_or7 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { calculerExperienceConstructionParHDVmine_or1 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or1.calc.js";
import { calculerExperienceConstructionParHDVmine_or2 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or2.calc.js";
import { calculerExperienceConstructionParHDVmine_or3 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or3.calc.js";
import { calculerExperienceConstructionParHDVmine_or4 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or4.calc.js";
import { calculerExperienceConstructionParHDVmine_or5 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or5.calc.js";
import { calculerExperienceConstructionParHDVmine_or6 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or6.calc.js";
import { calculerExperienceConstructionParHDVmine_or7 } from "/coc/code/village principal/batiments/calculator/ressource calc/mine ors/mine or7.calc.js";

import { formatPrix } from "/coc/code/outils/affichge nombre.js";
import { convertirSecondescompact } from "/coc/code/outils/convertisseurtemps.js";

function getHDVLevel() {
    return document.getElementById("hdv").value;
}

function getmine_orLevel(num) {
    return document.getElementById(`mine_or${num}`).value;
}

let hdvlevel = getHDVLevel(); // Récupérer le niveau de l'Hôtel de Ville

let mine_or1level = getmine_orLevel(1);
let mine_or2level = getmine_orLevel(2);
let mine_or3level = getmine_orLevel(3);
let mine_or4level = getmine_orLevel(4);
let mine_or5level = getmine_orLevel(5);
let mine_or6level = getmine_orLevel(6);
let mine_or7level = getmine_orLevel(7);

let mine_or1levelmax = mine_or1_nv_max_hdv(hdvlevel);
let mine_or2levelmax = mine_or2_nv_max_hdv(hdvlevel);
let mine_or3levelmax = mine_or3_nv_max_hdv(hdvlevel);
let mine_or4levelmax = mine_or4_nv_max_hdv(hdvlevel);
let mine_or5levelmax = mine_or5_nv_max_hdv(hdvlevel);
let mine_or6levelmax = mine_or6_nv_max_hdv(hdvlevel);
let mine_or7levelmax = mine_or7_nv_max_hdv(hdvlevel);

export function calculerPourcentageNiveauxmine_ors() {
    // Niveaux actuels
    const niveauxActuels = [
        Math.min(mine_or1level, mine_or1levelmax),
        Math.min(mine_or2level, mine_or2levelmax),
        Math.min(mine_or3level, mine_or3levelmax),
        Math.min(mine_or4level, mine_or4levelmax),
        Math.min(mine_or5level, mine_or5levelmax),
        Math.min(mine_or6level, mine_or6levelmax),
        Math.min(mine_or7level, mine_or7levelmax)
    ];

    // Niveaux max possibles selon HDV
    const niveauxMax = [
        mine_or1levelmax,
        mine_or2levelmax,
        mine_or3levelmax,
        mine_or4levelmax,
        mine_or5levelmax,
        mine_or6levelmax,
        mine_or7levelmax
    ];

    // Calcul des totaux
    const totalMax = niveauxMax.reduce((a, b) => a + b, 0);
    const totalActuel = niveauxActuels.reduce((a, b) => a + b, 0);

    if (totalMax === 0) return 0; // Évite la division par zéro

    const progression = (totalActuel / totalMax) * 100;
    return parseFloat(progression.toFixed(2)); // Limite a 2 décimales
}

export function globalcalculertempsRestantmine_ors() {
    const hdvlevel = parseInt(getHDVLevel(), 10);

    const mine_or1level = parseInt(getmine_orLevel(1), 10);
    const mine_or2level = parseInt(getmine_orLevel(2), 10);
    const mine_or3level = parseInt(getmine_orLevel(3), 10);
    const mine_or4level = parseInt(getmine_orLevel(4), 10);
    const mine_or5level = parseInt(getmine_orLevel(5), 10);
    const mine_or6level = parseInt(getmine_orLevel(6), 10);
    const mine_or7level = parseInt(getmine_orLevel(7), 10);

    const mine_or1levelmax = mine_or1_nv_max_hdv(hdvlevel);
    const mine_or2levelmax = mine_or2_nv_max_hdv(hdvlevel);
    const mine_or3levelmax = mine_or3_nv_max_hdv(hdvlevel);
    const mine_or4levelmax = mine_or4_nv_max_hdv(hdvlevel);
    const mine_or5levelmax = mine_or5_nv_max_hdv(hdvlevel);
    const mine_or6levelmax = mine_or6_nv_max_hdv(hdvlevel);
    const mine_or7levelmax = mine_or7_nv_max_hdv(hdvlevel);

    let tempsRestant = 0;
    tempsRestant += calculerTempsRestantmine_or1(mine_or1level, mine_or1levelmax);
    tempsRestant += calculerTempsRestantmine_or2(mine_or2level, mine_or2levelmax);
    tempsRestant += calculerTempsRestantmine_or3(mine_or3level, mine_or3levelmax);
    tempsRestant += calculerTempsRestantmine_or4(mine_or4level, mine_or4levelmax);
    tempsRestant += calculerTempsRestantmine_or5(mine_or5level, mine_or5levelmax);
    tempsRestant += calculerTempsRestantmine_or6(mine_or6level, mine_or6levelmax);
    tempsRestant += calculerTempsRestantmine_or7(mine_or7level, mine_or7levelmax);

    return tempsRestant;
}

export function globalcalculertempsTotalmine_ors() {
    let tempsTotal = 0;
    tempsTotal += calculerTempsTotalmine_or1(mine_or1level);
    tempsTotal += calculerTempsTotalmine_or2(mine_or2level);
    tempsTotal += calculerTempsTotalmine_or3(mine_or3level);
    tempsTotal += calculerTempsTotalmine_or4(mine_or4level);
    tempsTotal += calculerTempsTotalmine_or5(mine_or5level);
    tempsTotal += calculerTempsTotalmine_or6(mine_or6level);
    tempsTotal += calculerTempsTotalmine_or7(mine_or7level);
    return tempsTotal;
}

export function globalcalculertempsdepuisHDVmine_ors() {
    let tempsTotal = 0;
    tempsTotal += calculerTempsdepuisHDVmine_or1(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVmine_or2(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVmine_or3(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVmine_or4(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVmine_or5(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVmine_or6(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVmine_or7(hdvlevel);
    return tempsTotal;
}

export function globalcalculertempsConstructionParHDVmine_ors() {
    let tempsTotal = 0;
    tempsTotal += calculerTempsConstructionParHDVmine_or1(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVmine_or2(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVmine_or3(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVmine_or4(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVmine_or5(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVmine_or6(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVmine_or7(hdvlevel);
    return tempsTotal;
}

export function barredeprogressiontempsmine_ors() {
    const tempsTotal = globalcalculertempsTotalmine_ors();
    const tempsRestant = globalcalculertempsRestantmine_ors();
    const tempsConstructionHDV = globalcalculertempsConstructionParHDVmine_ors();

    if (tempsTotal === 0) {
        return 0; // Évite la division par zéro
    }

    if (tempsTotal >= tempsConstructionHDV) {
        const progression = ((tempsTotal - tempsRestant) / tempsTotal) * 100;
        return progression.toFixed(2);
    } else {
        // Ajout d'une tolérance pour éviter des valeurs négatives excessives
        const difference = tempsConstructionHDV - tempsTotal;
        if (difference < 0.01 * tempsConstructionHDV) { // Tolérance de 1%
            return 0; // Considérer comme aucune progression négative
        }
        const retard = (difference / tempsConstructionHDV) * 100;
        return (-retard).toFixed(2);
    }
}

export function globalcalculerPrixTotalmine_or() {
    let couttotal = 0;
    couttotal += calculerPrixTotalmine_or1(mine_or1level);
    couttotal += calculerPrixTotalmine_or2(mine_or2level);
    couttotal += calculerPrixTotalmine_or3(mine_or3level);
    couttotal += calculerPrixTotalmine_or4(mine_or4level);
    couttotal += calculerPrixTotalmine_or5(mine_or5level);
    couttotal += calculerPrixTotalmine_or6(mine_or6level);
    couttotal += calculerPrixTotalmine_or7(mine_or7level);
    return couttotal;
}

export function globalcalculerPrixRestantmine_or() {
    const hdvlevel = parseInt(getHDVLevel(), 10);

    const mine_or1level = parseInt(getmine_orLevel(1), 10);
    const mine_or2level = parseInt(getmine_orLevel(2), 10);
    const mine_or3level = parseInt(getmine_orLevel(3), 10);
    const mine_or4level = parseInt(getmine_orLevel(4), 10);
    const mine_or5level = parseInt(getmine_orLevel(5), 10);
    const mine_or6level = parseInt(getmine_orLevel(6), 10);
    const mine_or7level = parseInt(getmine_orLevel(7), 10);

    const mine_or1levelmax = mine_or1_nv_max_hdv(hdvlevel);
    const mine_or2levelmax = mine_or2_nv_max_hdv(hdvlevel);
    const mine_or3levelmax = mine_or3_nv_max_hdv(hdvlevel);
    const mine_or4levelmax = mine_or4_nv_max_hdv(hdvlevel);
    const mine_or5levelmax = mine_or5_nv_max_hdv(hdvlevel);
    const mine_or6levelmax = mine_or6_nv_max_hdv(hdvlevel);
    const mine_or7levelmax = mine_or7_nv_max_hdv(hdvlevel);

    let coutrestant = 0;
    coutrestant += calculerPrixRestantmine_or1(mine_or1level, mine_or1levelmax);
    coutrestant += calculerPrixRestantmine_or2(mine_or2level, mine_or2levelmax);
    coutrestant += calculerPrixRestantmine_or3(mine_or3level, mine_or3levelmax);
    coutrestant += calculerPrixRestantmine_or4(mine_or4level, mine_or4levelmax);
    coutrestant += calculerPrixRestantmine_or5(mine_or5level, mine_or5levelmax);
    coutrestant += calculerPrixRestantmine_or6(mine_or6level, mine_or6levelmax);
    coutrestant += calculerPrixRestantmine_or7(mine_or7level, mine_or7levelmax);
    return coutrestant;
}

export function globalcalculerPrixdepuisHDVmine_or() {
    let couttotal = 0;
    couttotal += calculerPrixdepuisHDVmine_or1(hdvlevel);
    couttotal += calculerPrixdepuisHDVmine_or2(hdvlevel);
    couttotal += calculerPrixdepuisHDVmine_or3(hdvlevel);
    couttotal += calculerPrixdepuisHDVmine_or4(hdvlevel);
    couttotal += calculerPrixdepuisHDVmine_or5(hdvlevel);
    couttotal += calculerPrixdepuisHDVmine_or6(hdvlevel);
    couttotal += calculerPrixdepuisHDVmine_or7(hdvlevel);
    return couttotal;
}

export function globalcalculerPrixConstructionParHDVmine_or() {
    let couttotal = 0;
    couttotal += calculerPrixConstructionParHDVmine_or1(hdvlevel);
    couttotal += calculerPrixConstructionParHDVmine_or2(hdvlevel);
    couttotal += calculerPrixConstructionParHDVmine_or3(hdvlevel);
    couttotal += calculerPrixConstructionParHDVmine_or4(hdvlevel);
    couttotal += calculerPrixConstructionParHDVmine_or5(hdvlevel);
    couttotal += calculerPrixConstructionParHDVmine_or6(hdvlevel);
    couttotal += calculerPrixConstructionParHDVmine_or7(hdvlevel);
    return couttotal;
}

export function barredeprogrssionprixmine_ors () {
    const prixTotal = globalcalculerprixTotalmine_ors();
    const prixRestant = globalcalculerprixRestantmine_ors();
    const prixConstructionHDV = globalcalculerprixConstructionParHDVmine_ors();
    if (prixTotal > prixConstructionHDV) {
        let progression = ((prixTotal - prixRestant) / prixTotal) * 100;
        return progression.toFixed(2);
    } else {
        let retard = ((prixConstructionHDV - prixTotal) / prixTotal) * 100;
        return (-retard).toFixed(2);
    }
}


export function globalcalculerExperienceTotalmine_or() {
    let expTotal = 0;
    expTotal += calculerExperienceTotalmine_or1(mine_or1level);
    expTotal += calculerExperienceTotalmine_or2(mine_or2level);
    expTotal += calculerExperienceTotalmine_or3(mine_or3level);
    expTotal += calculerExperienceTotalmine_or4(mine_or4level);
    expTotal += calculerExperienceTotalmine_or5(mine_or5level);
    expTotal += calculerExperienceTotalmine_or6(mine_or6level);
    expTotal += calculerExperienceTotalmine_or7(mine_or7level);
    return expTotal;
}

export function globalcalculerExperienceRestantmine_or() {
    let exprestant = 0;
    exprestant += calculerExperienceRestantmine_or1(mine_or1level, mine_or1levelmax);
    exprestant += calculerExperienceRestantmine_or2(mine_or2level, mine_or2levelmax);
    exprestant += calculerExperienceRestantmine_or3(mine_or3level, mine_or3levelmax);
    exprestant += calculerExperienceRestantmine_or4(mine_or4level, mine_or4levelmax);
    exprestant += calculerExperienceRestantmine_or5(mine_or5level, mine_or5levelmax);
    exprestant += calculerExperienceRestantmine_or6(mine_or6level, mine_or6levelmax);
    exprestant += calculerExperienceRestantmine_or7(mine_or7level, mine_or7levelmax);
    return exprestant;
}

export function globalcalculerExperiencedepuisHDVmine_or() {
    let exptotal = 0;
    exptotal += calculerExperiencedepuisHDVmine_or1(hdvlevel);
    exptotal += calculerExperiencedepuisHDVmine_or2(hdvlevel);
    exptotal += calculerExperiencedepuisHDVmine_or3(hdvlevel);
    exptotal += calculerExperiencedepuisHDVmine_or4(hdvlevel);
    exptotal += calculerExperiencedepuisHDVmine_or5(hdvlevel);
    exptotal += calculerExperiencedepuisHDVmine_or6(hdvlevel);
    exptotal += calculerExperiencedepuisHDVmine_or7(hdvlevel);
    return exptotal;
}

export function globalcalculerExperienceConstructionParHDVmine_or() {
    let exptotal = 0;
    exptotal += calculerExperienceConstructionParHDVmine_or1(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVmine_or2(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVmine_or3(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVmine_or4(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVmine_or5(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVmine_or6(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVmine_or7(hdvlevel);
    return exptotal;
}

export function barredeprogressionexpmine_ors() {
    const expTotal = globalcalculerExperienceTotalmine_or();
    const expRestant = globalcalculerExperienceRestantmine_or();
    const expConstructionHDV = globalcalculerExperienceConstructionParHDVmine_or();
    if (expTotal > expConstructionHDV) {
        let progression = ((expTotal - expRestant) / expTotal) * 100;
        return progression.toFixed(2);
    } else {
        let retard = ((expConstructionHDV - expTotal) / expTotal) * 100;
        return (-retard).toFixed(2);
    }
}

// Fonction pour mettre à jour la barre de progression
function updatemine_orProgress() {
    // Recalculer le niveau de l'Hôtel de Ville
    hdvlevel = getHDVLevel();

    // Recalculer les niveaux des mine_ors
    mine_or1level = getmine_orLevel(1);
    mine_or2level = getmine_orLevel(2);
    mine_or3level = getmine_orLevel(3);
    mine_or4level = getmine_orLevel(4);
    mine_or5level = getmine_orLevel(5);
    mine_or6level = getmine_orLevel(6);
    mine_or7level = getmine_orLevel(7);


    // Recalculer les niveaux maximums des mine_ors en fonction du niveau HDV
    mine_or1levelmax = mine_or1_nv_max_hdv(hdvlevel);
    mine_or2levelmax = mine_or2_nv_max_hdv(hdvlevel);
    mine_or3levelmax = mine_or3_nv_max_hdv(hdvlevel);
    mine_or4levelmax = mine_or4_nv_max_hdv(hdvlevel);
    mine_or5levelmax = mine_or5_nv_max_hdv(hdvlevel);
    mine_or6levelmax = mine_or6_nv_max_hdv(hdvlevel);
    mine_or7levelmax = mine_or7_nv_max_hdv(hdvlevel);
    // Calculer le pourcentage de progression
    const progression = calculerPourcentageNiveauxmine_ors();

    // Mettre à jour la barre de progression et le texte
    const progressBar = document.getElementById('progress-mine_ors');
    const progressText = document.getElementById('progress-mine_ors-value');
    const progressTimeText = document.getElementById('progress-mine_ors-temps');
    const progressPriceText = document.getElementById('progress-mine_ors-prix-elixir');

    if (progressBar && progressText) {
        progressBar.value = progression;
        progressText.textContent = `${progression}%`; // Limiter à 2 décimales
    }
    if (progressTimeText) {
        const tempsRestant = globalcalculertempsRestantmine_ors();
        progressTimeText.innerHTML = `${convertirSecondescompact(tempsRestant)} <img src="/coc/image/général/ressource/temps icone.png" alt="temps" class="icone-ressource">`;
    }
    if (progressPriceText) {
        const prixRestant = globalcalculerPrixRestantmine_or();
        progressPriceText.innerHTML = `${formatPrix(prixRestant)} <img src="/coc/image/village principal/ressource/elixir village-p.jpg" alt="or" class="icone-ressource">`;
    }
}

// Ajouter des écouteurs d'événements pour détecter les changements
document.addEventListener('DOMContentLoaded', () => {
    const mine_orSelects = [
        document.getElementById('mine_or1'),
        document.getElementById('mine_or2'),
        document.getElementById('mine_or3'),
        document.getElementById('mine_or4'),
        document.getElementById('mine_or5'),
        document.getElementById('mine_or6'),
        document.getElementById('mine_or7')
    ];

    // Ajouter un écouteur pour chaque mine_or
    mine_orSelects.forEach(select => {
        if (select) {
            select.addEventListener('change', updatemine_orProgress);
        }
    });

    // Ajouter un écouteur pour le changement du niveau HDV
    const hdvSelect = document.getElementById('hdv');
    if (hdvSelect) {
        hdvSelect.addEventListener('change', updatemine_orProgress);
    }

    // Initialiser la barre de progression au chargement
    updatemine_orProgress();
});