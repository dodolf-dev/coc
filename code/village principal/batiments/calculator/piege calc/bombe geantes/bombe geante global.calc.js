import { bombe_geante1_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";
import { bombe_geante2_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { bombe_geante3_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { bombe_geante4_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { bombe_geante5_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { bombe_geante6_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { bombe_geante7_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { bombe_geante8_nv_max_hdv } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { calculerTempsTotalbombe_geante1 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";
import { calculerTempsTotalbombe_geante2 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { calculerTempsTotalbombe_geante3 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { calculerTempsTotalbombe_geante4 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { calculerTempsTotalbombe_geante5 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { calculerTempsTotalbombe_geante6 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { calculerTempsTotalbombe_geante7 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { calculerTempsTotalbombe_geante8 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { calculerTempsRestantbombe_geante1 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";    
import { calculerTempsRestantbombe_geante2 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { calculerTempsRestantbombe_geante3 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { calculerTempsRestantbombe_geante4 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { calculerTempsRestantbombe_geante5 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { calculerTempsRestantbombe_geante6 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { calculerTempsRestantbombe_geante7 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { calculerTempsRestantbombe_geante8 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { calculerTempsdepuisHDVbombe_geante1 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";
import { calculerTempsdepuisHDVbombe_geante2 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { calculerTempsdepuisHDVbombe_geante3 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { calculerTempsdepuisHDVbombe_geante4 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { calculerTempsdepuisHDVbombe_geante5 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { calculerTempsdepuisHDVbombe_geante6 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { calculerTempsdepuisHDVbombe_geante7 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { calculerTempsdepuisHDVbombe_geante8 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { calculerTempsConstructionParHDVbombe_geante1 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";
import { calculerTempsConstructionParHDVbombe_geante2 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { calculerTempsConstructionParHDVbombe_geante3 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { calculerTempsConstructionParHDVbombe_geante4 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { calculerTempsConstructionParHDVbombe_geante5 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { calculerTempsConstructionParHDVbombe_geante6 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { calculerTempsConstructionParHDVbombe_geante7 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { calculerTempsConstructionParHDVbombe_geante8 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { calculerPrixTotalbombe_geante1 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";
import { calculerPrixTotalbombe_geante2 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { calculerPrixTotalbombe_geante3 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { calculerPrixTotalbombe_geante4 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { calculerPrixTotalbombe_geante5 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { calculerPrixTotalbombe_geante6 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { calculerPrixTotalbombe_geante7 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { calculerPrixTotalbombe_geante8 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { calculerPrixRestantbombe_geante1 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";
import { calculerPrixRestantbombe_geante2 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { calculerPrixRestantbombe_geante3 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { calculerPrixRestantbombe_geante4 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { calculerPrixRestantbombe_geante5 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { calculerPrixRestantbombe_geante6 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { calculerPrixRestantbombe_geante7 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { calculerPrixRestantbombe_geante8 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { calculerPrixdepuisHDVbombe_geante1 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";
import { calculerPrixdepuisHDVbombe_geante2 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { calculerPrixdepuisHDVbombe_geante3 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { calculerPrixdepuisHDVbombe_geante4 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { calculerPrixdepuisHDVbombe_geante5 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { calculerPrixdepuisHDVbombe_geante6 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { calculerPrixdepuisHDVbombe_geante7 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { calculerPrixdepuisHDVbombe_geante8 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { calculerPrixConstructionParHDVbombe_geante1 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";
import { calculerPrixConstructionParHDVbombe_geante2 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { calculerPrixConstructionParHDVbombe_geante3 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { calculerPrixConstructionParHDVbombe_geante4 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { calculerPrixConstructionParHDVbombe_geante5 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { calculerPrixConstructionParHDVbombe_geante6 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { calculerPrixConstructionParHDVbombe_geante7 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { calculerPrixConstructionParHDVbombe_geante8 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { calculerExperienceTotalbombe_geante1 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";
import { calculerExperienceTotalbombe_geante2 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { calculerExperienceTotalbombe_geante3 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { calculerExperienceTotalbombe_geante4 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { calculerExperienceTotalbombe_geante5 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { calculerExperienceTotalbombe_geante6 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { calculerExperienceTotalbombe_geante7 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { calculerExperienceTotalbombe_geante8 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { calculerExperienceRestantbombe_geante1 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";
import { calculerExperienceRestantbombe_geante2 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { calculerExperienceRestantbombe_geante3 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { calculerExperienceRestantbombe_geante4 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { calculerExperienceRestantbombe_geante5 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { calculerExperienceRestantbombe_geante6 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { calculerExperienceRestantbombe_geante7 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { calculerExperienceRestantbombe_geante8 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { calculerExperiencedepuisHDVbombe_geante1 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";
import { calculerExperiencedepuisHDVbombe_geante2 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { calculerExperiencedepuisHDVbombe_geante3 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { calculerExperiencedepuisHDVbombe_geante4 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { calculerExperiencedepuisHDVbombe_geante5 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { calculerExperiencedepuisHDVbombe_geante6 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { calculerExperiencedepuisHDVbombe_geante7 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { calculerExperiencedepuisHDVbombe_geante8 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { calculerExperienceConstructionParHDVbombe_geante1 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante1.calc.js";
import { calculerExperienceConstructionParHDVbombe_geante2 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante2.calc.js";
import { calculerExperienceConstructionParHDVbombe_geante3 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante3.calc.js";
import { calculerExperienceConstructionParHDVbombe_geante4 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante4.calc.js";
import { calculerExperienceConstructionParHDVbombe_geante5 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante5.calc.js";
import { calculerExperienceConstructionParHDVbombe_geante6 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante6.calc.js";
import { calculerExperienceConstructionParHDVbombe_geante7 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante7.calc.js";
import { calculerExperienceConstructionParHDVbombe_geante8 } from "/coc/code/village principal/batiments/calculator/piege calc/bombe geantes/bombe geante8.calc.js";

import { formatPrix } from "/coc/code/outils/affichge nombre.js";
import { convertirSecondescompact } from "/coc/code/outils/convertisseurtemps.js";

function getHDVLevel() {
    return document.getElementById("hdv").value;
}

function getbombe_geanteLevel(num) {
    return document.getElementById(`bombe_geante${num}`).value;
}

let hdvlevel = getHDVLevel(); // Récupérer le niveau de l'Hôtel de Ville

let bombe_geante1level = getbombe_geanteLevel(1);
let bombe_geante2level = getbombe_geanteLevel(2);
let bombe_geante3level = getbombe_geanteLevel(3);
let bombe_geante4level = getbombe_geanteLevel(4);
let bombe_geante5level = getbombe_geanteLevel(5);
let bombe_geante6level = getbombe_geanteLevel(6);
let bombe_geante7level = getbombe_geanteLevel(7);
let bombe_geante8level = getbombe_geanteLevel(8);

let bombe_geante1levelmax = bombe_geante1_nv_max_hdv(hdvlevel);
let bombe_geante2levelmax = bombe_geante2_nv_max_hdv(hdvlevel);
let bombe_geante3levelmax = bombe_geante3_nv_max_hdv(hdvlevel);
let bombe_geante4levelmax = bombe_geante4_nv_max_hdv(hdvlevel);
let bombe_geante5levelmax = bombe_geante5_nv_max_hdv(hdvlevel);
let bombe_geante6levelmax = bombe_geante6_nv_max_hdv(hdvlevel);
let bombe_geante7levelmax = bombe_geante7_nv_max_hdv(hdvlevel);
let bombe_geante8levelmax = bombe_geante8_nv_max_hdv(hdvlevel);

export function calculerPourcentageNiveauxbombe_geantes() {
    // Niveaux actuels
    const niveauxActuels = [
        Math.min(bombe_geante1level, bombe_geante1levelmax),
        Math.min(bombe_geante2level, bombe_geante2levelmax),
        Math.min(bombe_geante3level, bombe_geante3levelmax),
        Math.min(bombe_geante4level, bombe_geante4levelmax),
        Math.min(bombe_geante5level, bombe_geante5levelmax),
        Math.min(bombe_geante6level, bombe_geante6levelmax),
        Math.min(bombe_geante7level, bombe_geante7levelmax),
        Math.min(bombe_geante8level, bombe_geante8levelmax),
    ];

    // Niveaux max possibles selon HDV
    const niveauxMax = [
        bombe_geante1levelmax,
        bombe_geante2levelmax,
        bombe_geante3levelmax,
        bombe_geante4levelmax,
        bombe_geante5levelmax,
        bombe_geante6levelmax,
        bombe_geante7levelmax,
        bombe_geante8levelmax,
    ];

    // Calcul des totaux
    const totalMax = niveauxMax.reduce((a, b) => a + b, 0);
    const totalActuel = niveauxActuels.reduce((a, b) => a + b, 0);

    if (totalMax === 0) return 0; // Évite la division par zéro

    const progression = (totalActuel / totalMax) * 100;
    return parseFloat(progression.toFixed(2)); // Limite a 2 décimales
}

export function globalcalculertempsRestantbombe_geantes() {
    const hdvlevel = parseInt(getHDVLevel(), 10);

    const bombe_geante1level = parseInt(getbombe_geanteLevel(1), 10);
    const bombe_geante2level = parseInt(getbombe_geanteLevel(2), 10);
    const bombe_geante3level = parseInt(getbombe_geanteLevel(3), 10);
    const bombe_geante4level = parseInt(getbombe_geanteLevel(4), 10);
    const bombe_geante5level = parseInt(getbombe_geanteLevel(5), 10);
    const bombe_geante6level = parseInt(getbombe_geanteLevel(6), 10);
    const bombe_geante7level = parseInt(getbombe_geanteLevel(7), 10);
    const bombe_geante8level = parseInt(getbombe_geanteLevel(8), 10);

    const bombe_geante1levelmax = bombe_geante1_nv_max_hdv(hdvlevel);
    const bombe_geante2levelmax = bombe_geante2_nv_max_hdv(hdvlevel);
    const bombe_geante3levelmax = bombe_geante3_nv_max_hdv(hdvlevel);
    const bombe_geante4levelmax = bombe_geante4_nv_max_hdv(hdvlevel);
    const bombe_geante5levelmax = bombe_geante5_nv_max_hdv(hdvlevel);
    const bombe_geante6levelmax = bombe_geante6_nv_max_hdv(hdvlevel);
    const bombe_geante7levelmax = bombe_geante7_nv_max_hdv(hdvlevel);
    const bombe_geante8levelmax = bombe_geante8_nv_max_hdv(hdvlevel);

    let tempsRestant = 0;
    tempsRestant += calculerTempsRestantbombe_geante1(bombe_geante1level, bombe_geante1levelmax);
    tempsRestant += calculerTempsRestantbombe_geante2(bombe_geante2level, bombe_geante2levelmax);
    tempsRestant += calculerTempsRestantbombe_geante3(bombe_geante3level, bombe_geante3levelmax);
    tempsRestant += calculerTempsRestantbombe_geante4(bombe_geante4level, bombe_geante4levelmax);
    tempsRestant += calculerTempsRestantbombe_geante5(bombe_geante5level, bombe_geante5levelmax);
    tempsRestant += calculerTempsRestantbombe_geante6(bombe_geante6level, bombe_geante6levelmax);
    tempsRestant += calculerTempsRestantbombe_geante7(bombe_geante7level, bombe_geante7levelmax);
    tempsRestant += calculerTempsRestantbombe_geante8(bombe_geante8level, bombe_geante8levelmax);
    return tempsRestant;
}

export function globalcalculertempsTotalbombe_geantes() {
    let tempsTotal = 0;
    tempsTotal += calculerTempsTotalbombe_geante1(bombe_geante1level);
    tempsTotal += calculerTempsTotalbombe_geante2(bombe_geante2level);
    tempsTotal += calculerTempsTotalbombe_geante3(bombe_geante3level);
    tempsTotal += calculerTempsTotalbombe_geante4(bombe_geante4level);
    tempsTotal += calculerTempsTotalbombe_geante5(bombe_geante5level);
    tempsTotal += calculerTempsTotalbombe_geante6(bombe_geante6level);
    tempsTotal += calculerTempsTotalbombe_geante7(bombe_geante7level);
    tempsTotal += calculerTempsTotalbombe_geante8(bombe_geante8level);
    return tempsTotal;
}

export function globalcalculertempsdepuisHDVbombe_geantes() {
    let tempsTotal = 0;
    tempsTotal += calculerTempsdepuisHDVbombe_geante1(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVbombe_geante2(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVbombe_geante3(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVbombe_geante4(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVbombe_geante5(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVbombe_geante6(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVbombe_geante7(hdvlevel);
    tempsTotal += calculerTempsdepuisHDVbombe_geante8(hdvlevel);
    return tempsTotal;
}

export function globalcalculertempsConstructionParHDVbombe_geantes() {
    let tempsTotal = 0;
    tempsTotal += calculerTempsConstructionParHDVbombe_geante1(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVbombe_geante2(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVbombe_geante3(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVbombe_geante4(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVbombe_geante5(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVbombe_geante6(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVbombe_geante7(hdvlevel);
    tempsTotal += calculerTempsConstructionParHDVbombe_geante8(hdvlevel);
    return tempsTotal;
}

export function barredeprogressiontempsbombe_geantes() {
    const tempsTotal = globalcalculertempsTotalbombe_geantes();
    const tempsRestant = globalcalculertempsRestantbombe_geantes();
    const tempsConstructionHDV = globalcalculertempsConstructionParHDVbombe_geantes();

    if (tempsTotal === 0) {
        return 0; // Évite la division par zéro
    }

    if (tempsTotal >= tempsConstructionHDV) {
        const progression = ((tempsTotal - tempsRestant) / tempsTotal) * 100;
        return progression.toFixed(2);
    } else {
        // Ajout d'une tolérance pour éviter des valeurs négatives excessives
        const difference = tempsConstructionHDV - tempsTotal;
        if (difference < 0.01 * tempsConstructionHDV) { // Tolérance de 1%
            return 0; // Considérer comme aucune progression négative
        }
        const retard = (difference / tempsConstructionHDV) * 100;
        return (-retard).toFixed(2);
    }
}

export function globalcalculerPrixTotalbombe_geante() {
    let couttotal = 0;
    couttotal += calculerPrixTotalbombe_geante1(bombe_geante1level);
    couttotal += calculerPrixTotalbombe_geante2(bombe_geante2level);
    couttotal += calculerPrixTotalbombe_geante3(bombe_geante3level);
    couttotal += calculerPrixTotalbombe_geante4(bombe_geante4level);
    couttotal += calculerPrixTotalbombe_geante5(bombe_geante5level);
    couttotal += calculerPrixTotalbombe_geante6(bombe_geante6level);
    couttotal += calculerPrixTotalbombe_geante7(bombe_geante7level);
    couttotal += calculerPrixTotalbombe_geante8(bombe_geante8level);
    return couttotal;
}

export function globalcalculerPrixRestantbombe_geante() {
    const hdvlevel = parseInt(getHDVLevel(), 10);

    const bombe_geante1level = parseInt(getbombe_geanteLevel(1), 10);
    const bombe_geante2level = parseInt(getbombe_geanteLevel(2), 10);
    const bombe_geante3level = parseInt(getbombe_geanteLevel(3), 10);
    const bombe_geante4level = parseInt(getbombe_geanteLevel(4), 10);
    const bombe_geante5level = parseInt(getbombe_geanteLevel(5), 10);
    const bombe_geante6level = parseInt(getbombe_geanteLevel(6), 10);
    const bombe_geante7level = parseInt(getbombe_geanteLevel(7), 10);
    const bombe_geante8level = parseInt(getbombe_geanteLevel(8), 10);

    const bombe_geante1levelmax = bombe_geante1_nv_max_hdv(hdvlevel);
    const bombe_geante2levelmax = bombe_geante2_nv_max_hdv(hdvlevel);
    const bombe_geante3levelmax = bombe_geante3_nv_max_hdv(hdvlevel);
    const bombe_geante4levelmax = bombe_geante4_nv_max_hdv(hdvlevel);
    const bombe_geante5levelmax = bombe_geante5_nv_max_hdv(hdvlevel);
    const bombe_geante6levelmax = bombe_geante6_nv_max_hdv(hdvlevel);
    const bombe_geante7levelmax = bombe_geante7_nv_max_hdv(hdvlevel);
    const bombe_geante8levelmax = bombe_geante8_nv_max_hdv(hdvlevel);

    let coutrestant = 0;
    coutrestant += calculerPrixRestantbombe_geante1(bombe_geante1level, bombe_geante1levelmax);
    coutrestant += calculerPrixRestantbombe_geante2(bombe_geante2level, bombe_geante2levelmax);
    coutrestant += calculerPrixRestantbombe_geante3(bombe_geante3level, bombe_geante3levelmax);
    coutrestant += calculerPrixRestantbombe_geante4(bombe_geante4level, bombe_geante4levelmax);
    coutrestant += calculerPrixRestantbombe_geante5(bombe_geante5level, bombe_geante5levelmax);
    coutrestant += calculerPrixRestantbombe_geante6(bombe_geante6level, bombe_geante6levelmax);
    coutrestant += calculerPrixRestantbombe_geante7(bombe_geante7level, bombe_geante7levelmax);
    coutrestant += calculerPrixRestantbombe_geante8(bombe_geante8level, bombe_geante8levelmax);
    return coutrestant;
}

export function globalcalculerPrixdepuisHDVbombe_geante() {
    let couttotal = 0;
    couttotal += calculerPrixdepuisHDVbombe_geante1(hdvlevel);
    couttotal += calculerPrixdepuisHDVbombe_geante2(hdvlevel);
    couttotal += calculerPrixdepuisHDVbombe_geante3(hdvlevel);
    couttotal += calculerPrixdepuisHDVbombe_geante4(hdvlevel);
    couttotal += calculerPrixdepuisHDVbombe_geante5(hdvlevel);
    couttotal += calculerPrixdepuisHDVbombe_geante6(hdvlevel);
    couttotal += calculerPrixdepuisHDVbombe_geante7(hdvlevel);
    couttotal += calculerPrixdepuisHDVbombe_geante8(hdvlevel);
    return couttotal;
}

export function globalcalculerPrixConstructionParHDVbombe_geante() {
    let couttotal = 0;
    couttotal += calculerPrixConstructionParHDVbombe_geante1(hdvlevel);
    couttotal += calculerPrixConstructionParHDVbombe_geante2(hdvlevel);
    couttotal += calculerPrixConstructionParHDVbombe_geante3(hdvlevel);
    couttotal += calculerPrixConstructionParHDVbombe_geante4(hdvlevel);
    couttotal += calculerPrixConstructionParHDVbombe_geante5(hdvlevel);
    couttotal += calculerPrixConstructionParHDVbombe_geante6(hdvlevel);
    couttotal += calculerPrixConstructionParHDVbombe_geante7(hdvlevel);
    couttotal += calculerPrixConstructionParHDVbombe_geante8(hdvlevel);
    return couttotal;
}

export function barredeprogrssionprixbombe_geantes () {
    const prixTotal = globalcalculerprixTotalbombe_geantes();
    const prixRestant = globalcalculerprixRestantbombe_geantes();
    const prixConstructionHDV = globalcalculerprixConstructionParHDVbombe_geantes();
    if (prixTotal > prixConstructionHDV) {
        let progression = ((prixTotal - prixRestant) / prixTotal) * 100;
        return progression.toFixed(2);
    } else {
        let retard = ((prixConstructionHDV - prixTotal) / prixTotal) * 100;
        return (-retard).toFixed(2);
    }
}


export function globalcalculerExperienceTotalbombe_geante() {
    let expTotal = 0;
    expTotal += calculerExperienceTotalbombe_geante1(bombe_geante1level);
    expTotal += calculerExperienceTotalbombe_geante2(bombe_geante2level);
    expTotal += calculerExperienceTotalbombe_geante3(bombe_geante3level);
    expTotal += calculerExperienceTotalbombe_geante4(bombe_geante4level);
    expTotal += calculerExperienceTotalbombe_geante5(bombe_geante5level);
    expTotal += calculerExperienceTotalbombe_geante6(bombe_geante6level);
    expTotal += calculerExperienceTotalbombe_geante7(bombe_geante7level);
    expTotal += calculerExperienceTotalbombe_geante8(bombe_geante8level);
    return expTotal;
}

export function globalcalculerExperienceRestantbombe_geante() {
    let exprestant = 0;
    exprestant += calculerExperienceRestantbombe_geante1(bombe_geante1level, bombe_geante1levelmax);
    exprestant += calculerExperienceRestantbombe_geante2(bombe_geante2level, bombe_geante2levelmax);
    exprestant += calculerExperienceRestantbombe_geante3(bombe_geante3level, bombe_geante3levelmax);
    exprestant += calculerExperienceRestantbombe_geante4(bombe_geante4level, bombe_geante4levelmax);
    exprestant += calculerExperienceRestantbombe_geante5(bombe_geante5level, bombe_geante5levelmax);
    exprestant += calculerExperienceRestantbombe_geante6(bombe_geante6level, bombe_geante6levelmax);
    exprestant += calculerExperienceRestantbombe_geante7(bombe_geante7level, bombe_geante7levelmax);
    exprestant += calculerExperienceRestantbombe_geante8(bombe_geante8level, bombe_geante8levelmax);
    return exprestant;
}

export function globalcalculerExperiencedepuisHDVbombe_geante() {
    let exptotal = 0;
    exptotal += calculerExperiencedepuisHDVbombe_geante1(hdvlevel);
    exptotal += calculerExperiencedepuisHDVbombe_geante2(hdvlevel);
    exptotal += calculerExperiencedepuisHDVbombe_geante3(hdvlevel);
    exptotal += calculerExperiencedepuisHDVbombe_geante4(hdvlevel);
    exptotal += calculerExperiencedepuisHDVbombe_geante5(hdvlevel);
    exptotal += calculerExperiencedepuisHDVbombe_geante6(hdvlevel);
    exptotal += calculerExperiencedepuisHDVbombe_geante7(hdvlevel);
    exptotal += calculerExperiencedepuisHDVbombe_geante8(hdvlevel);
    return exptotal;
}

export function globalcalculerExperienceConstructionParHDVbombe_geante() {
    let exptotal = 0;
    exptotal += calculerExperienceConstructionParHDVbombe_geante1(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVbombe_geante2(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVbombe_geante3(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVbombe_geante4(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVbombe_geante5(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVbombe_geante6(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVbombe_geante7(hdvlevel);
    exptotal += calculerExperienceConstructionParHDVbombe_geante8(hdvlevel);
    return exptotal;
}

export function barredeprogressionexpbombe_geantes() {
    const expTotal = globalcalculerExperienceTotalbombe_geante();
    const expRestant = globalcalculerExperienceRestantbombe_geante();
    const expConstructionHDV = globalcalculerExperienceConstructionParHDVbombe_geante();
    if (expTotal > expConstructionHDV) {
        let progression = ((expTotal - expRestant) / expTotal) * 100;
        return progression.toFixed(2);
    } else {
        let retard = ((expConstructionHDV - expTotal) / expTotal) * 100;
        return (-retard).toFixed(2);
    }
}

// Fonction pour mettre à jour la barre de progression
function updatebombe_geanteProgress() {
    // Recalculer le niveau de l'Hôtel de Ville
    hdvlevel = getHDVLevel();

    // Recalculer les niveaux des bombe_geantes
    bombe_geante1level = getbombe_geanteLevel(1);
    bombe_geante2level = getbombe_geanteLevel(2);
    bombe_geante3level = getbombe_geanteLevel(3);
    bombe_geante4level = getbombe_geanteLevel(4);
    bombe_geante5level = getbombe_geanteLevel(5);
    bombe_geante6level = getbombe_geanteLevel(6);
    bombe_geante7level = getbombe_geanteLevel(7);
    bombe_geante8level = getbombe_geanteLevel(8);

    // Recalculer les niveaux maximums des bombe_geantes en fonction du niveau HDV
    bombe_geante1levelmax = bombe_geante1_nv_max_hdv(hdvlevel);
    bombe_geante2levelmax = bombe_geante2_nv_max_hdv(hdvlevel);
    bombe_geante3levelmax = bombe_geante3_nv_max_hdv(hdvlevel);
    bombe_geante4levelmax = bombe_geante4_nv_max_hdv(hdvlevel);
    bombe_geante5levelmax = bombe_geante5_nv_max_hdv(hdvlevel);
    bombe_geante6levelmax = bombe_geante6_nv_max_hdv(hdvlevel);
    bombe_geante7levelmax = bombe_geante7_nv_max_hdv(hdvlevel);
    bombe_geante8levelmax = bombe_geante8_nv_max_hdv(hdvlevel);
    // Calculer le pourcentage de progression
    const progression = calculerPourcentageNiveauxbombe_geantes();

    // Mettre à jour la barre de progression et le texte
    const progressBar = document.getElementById('progress-bombe_geantes');
    const progressText = document.getElementById('progress-bombe_geantes-value');
    const progressTimeText = document.getElementById('progress-bombe_geantes-temps');
    const progressPriceText = document.getElementById('progress-bombe_geantes-prix-or');

    if (progressBar && progressText) {
        progressBar.value = progression;
        progressText.textContent = `${progression.toFixed(2)}%`; // Limiter à 2 décimales
    }
    if (progressTimeText) {
        const tempsRestant = globalcalculertempsRestantbombe_geantes();
        if (tempsRestant === 0) {
            progressTimeText.style.display = "none";
        }
        else {
            progressTimeText.style.display = "";
            progressTimeText.innerHTML = `${convertirSecondescompact(tempsRestant)} <img src="/coc/image/général/ressource/temps icone.png" alt="temps" class="icone-ressource">`;
        }
    }
    if (progressPriceText) {
        const prixRestant = globalcalculerPrixRestantbombe_geante();
        if (prixRestant === 0){
            progressPriceText.style.display = "none";
        }
        else {
            progressPriceText.style.display = "";
            progressPriceText.innerHTML = `${formatPrix(prixRestant)} <img src="/coc/image/village principal/ressource/or village-p.jpg" alt="or" class="icone-ressource">`;
        }
    }
}

// Ajouter des écouteurs d'événements pour détecter les changements
document.addEventListener('DOMContentLoaded', () => {
    const bombe_geanteSelects = [
        document.getElementById('bombe_geante1'),
        document.getElementById('bombe_geante2'),
        document.getElementById('bombe_geante3'),
        document.getElementById('bombe_geante4'),
        document.getElementById('bombe_geante5'),
        document.getElementById('bombe_geante6'),
        document.getElementById('bombe_geante7'),
        document.getElementById('bombe_geante8'),
    ];

    // Ajouter un écouteur pour chaque bombe_geante
    bombe_geanteSelects.forEach(select => {
        if (select) {
            select.addEventListener('change', updatebombe_geanteProgress);
        }
    });

    // Ajouter un écouteur pour le changement du niveau HDV
    const hdvSelect = document.getElementById('hdv');
    if (hdvSelect) {
        hdvSelect.addEventListener('change', updatebombe_geanteProgress);
    }

    // Initialiser la barre de progression au chargement
    updatebombe_geanteProgress();
});